<!DOCTYPE html>
<html lang="uz">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <link rel="icon" type="image/png" href="FT Logo 1.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAI Journal - Oxirgi Maqolalar</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo">
                <a href="index.html"> <img src="logo-FER TEACH.png"></a>
            </div>
            <nav>
                <a href="index.html#services">Xizmatlar</a>
                <a href="index.html#journals">Jurnallar</a>
                <a href="index.html#contact">Aloqa</a>
                <a href="about.html">About</a>
                <button id="themeToggle" class="theme-toggle" onclick="toggleTheme()">üåô</button>
            </nav>
        </div>
    </header>

    <!-- Journal Header -->
    <section class="journal-header">
        <div class="container">
            <div class="journal-info">
                <div class="journal-cover-container">
                    <img src="tadqiq.png" alt="RAI Journal" class="journal-cover">
                </div>
                <div class="journal-details">
                    <h1>RAI Journal</h1>
                    <p class="journal-description">
                        Aniq va tabiiy fanlar, ijtimoiy-iqtisodiy fanlar, pedagogika fanlari sohalarini qamrab oluvchi ilmiy-uslubiy jurnal. 
                        Zamonaviy tadqiqotlar va innovatsion yondashuvlar bilan tanishing.
                    </p>
                    <div class="journal-stats-header">
                        <div class="stat-item">
                            <span class="stat-number" id="articlesCount">Yuklanmoqda...</span>
                            <span class="stat-label">Maqolalar</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">1250</span>
                            <span class="stat-label">Obunachi</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">2024</span>
                            <span class="stat-label">Yil</span>
                        </div>
                    </div>
                    <div style="margin-top: 2rem;">
                        <a href="https://rai-journal.uz" target="_blank" class="btn btn-primary" style="margin-right: 1rem;">
                            <i class="fas fa-external-link-alt"></i> Rasmiy Saytga O'tish
                        </a>
                        <a href="https://t.me/ferteach_uz" target="_blank" class="btn btn-success">
                            <i class="fab fa-telegram"></i> Telegram
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Loading Indicator -->
    <div id="loadingIndicator" style="text-align: center; padding: 2rem;">
        <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #2563eb; border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <p style="margin-top: 1rem; color: #6b7280;">Maqolalar yuklanmoqda...</p>
    </div>

    <!-- Articles Section -->
    <section class="articles-section" id="articlesSection" style="display: none;">
        <div class="container">
            <div class="section-header">
                <h2>Oxirgi Maqolalar</h2>
                <p>RAI Journal da nashr etilgan eng so'nggi ilmiy maqolalar</p>
            </div>

            <div class="articles-grid" id="articlesGrid">
                <!-- Maqolalar bu yerga JavaScript orqali yuklanadi -->
            </div>

            <!-- Error Message -->
            <div id="errorMessage" style="display: none; text-align: center; padding: 3rem;">
                <div style="color: #ef4444; font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
                <h3 style="color: #ef4444; margin-bottom: 1rem;">Maqolalarni yuklashda xatolik</h3>
                <p style="color: #6b7280; margin-bottom: 2rem;">
                    Jurnal saytiga ulanishda muammo yuz berdi. Iltimos, keyinroq qayta urinib ko'ring.
                </p>
                <button onclick="loadArticles()" class="btn btn-primary">
                    <i class="fas fa-redo"></i> Qayta yuklash
                </button>
            </div>

            <!-- Back Section -->
            <div class="back-section">
                <a href="index.html" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Jurnallar ro'yxatiga qaytish
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-grid">
                <!-- About -->
                <div>
                    <h3>RAI Journal Haqida</h3>
                    <p>Aniq va tabiiy fanlar, ijtimoiy-iqtisodiy fanlar, pedagogika fanlari sohalarida ilmiy tadqiqotlar va innovatsion yechimlar.</p>
                    <p style="color: #60a5fa;">Ilm-fan taraqqiyoti yo'lida birgalikda!</p>
                </div>

                <!-- Contact -->
                <div>
                    <h3>Bog'lanish</h3>
                    <div class="contact-item">
                        <span class="contact-icon">‚úâÔ∏è</span>
                        <div>
                            <p>Email:</p>
                            <a href="mailto:yunusaliyunusov83@gmail.com">yunusaliyunusov83@gmail.com</a>
                        </div>
                    </div>
                    <div class="contact-item">
                        <span class="contact-icon">üìû</span>
                        <div>
                            <p>Telefon:</p>
                            <a href="tel:+998930532288">+998 93 053 22 88</a>
                        </div>
                    </div>
                </div>

                <!-- Links -->
                <div>
                    <h3>Foydali Havolalar</h3>
                    <p><a href="https://rai-journal.uz" target="_blank">RAI Journal Rasmiy Sayti</a></p>
                    <p><a href="index.html">Boshqa Jurnallar</a></p>
                    <p><a href="index.html#services">Bizning Xizmatlar</a></p>
                </div>
            </div>

            <div class="copyright">
                <p>¬© 2024 FerTeach. Barcha huquqlar himoyalangan.</p>
            </div>
        </div>
    </footer>

    <!-- CSS for loading animation -->
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .journal-cover-container {
            text-align: center;
        }
        
        .article-card {
            background: white;
            border-radius: 0.75rem;
            padding: 2rem;
            border: 1px solid #e5e7eb;
            transition: all 0.3s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .article-card:hover {
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }
        
        .article-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2563eb;
            margin-bottom: 0.75rem;
            line-height: 1.4;
        }
        
        .article-author {
            color: #059669;
            font-size: 0.875rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .article-excerpt {
            color: #374151;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        
        .article-meta {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .article-date, .article-views {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .article-buttons {
            display: flex;
            gap: 0.75rem;
        }
    </style>

    <script src="script.js"></script>
    <script>
        // RAI Journal real scraping funksiyasi
        async function loadArticles() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            const articlesSection = document.getElementById('articlesSection');
            const errorMessage = document.getElementById('errorMessage');
            const articlesGrid = document.getElementById('articlesGrid');
            const articlesCount = document.getElementById('articlesCount');

            // Loading ko'rsatish
            loadingIndicator.style.display = 'block';
            articlesSection.style.display = 'none';
            errorMessage.style.display = 'none';

            try {
                // Bir necha proxy URL larni sinab ko'rish
                const proxyUrls = [
                    'https://api.allorigins.win/get?url=',
                    'https://cors-anywhere.herokuapp.com/',
                    'https://thingproxy.freeboard.io/fetch/'
                ];
                
                let articles = [];
                let success = false;

                // Har bir proxy bilan urinish
                for (const proxyUrl of proxyUrls) {
                    try {
                        console.log(`${proxyUrl} bilan urinish...`);
                        
                        let response;
                        let html;
                        
                        if (proxyUrl.includes('allorigins')) {
                            response = await fetch(proxyUrl + encodeURIComponent('https://rai-journal.uz'));
                            const data = await response.json();
                            html = data.contents;
                        } else {
                            response = await fetch(proxyUrl + 'https://rai-journal.uz');
                            html = await response.text();
                        }
                        
                        if (html && html.length > 1000) {
                            // HTML ni parse qilish
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(html, 'text/html');
                            
                            // RAI saytidan maqolalarni ajratib olish
                            articles = extractArticlesFromRAI(doc);
                            
                            if (articles.length > 0) {
                                success = true;
                                console.log(`${proxyUrl} bilan muvaffaqiyatli! ${articles.length} ta maqola topildi.`);
                                break;
                            }
                        }
                    } catch (proxyError) {
                        console.log(`${proxyUrl} ishlamadi:`, proxyError.message);
                        continue;
                    }
                }
                
                // Agar hech qaysi proxy ishlamasa yoki maqola topilmasa
                if (!success || articles.length === 0) {
                    console.log('Real scraping ishlamadi, xatolik xabari ko\'rsatiladi');
                    showErrorMessage();
                    return;
                }
                
                // Maqolalarni ko'rsatish
                displayArticles(articles);
                articlesCount.textContent = articles.length;
                
                // Loading yashirish va maqolalar ko'rsatish
                loadingIndicator.style.display = 'none';
                articlesSection.style.display = 'block';
                
            } catch (error) {
                console.error('Umumiy scraping xatosi:', error);
                showErrorMessage();
            }
        }

        // RAI saytidan maqolalarni ajratib olish (yaxshilangan)
        function extractArticlesFromRAI(doc) {
            const articles = [];
            console.log('RAI saytini parse qilish boshlandi...');
            
            // RAI saytining turli strukturalarini sinab ko'rish
            const possibleSelectors = [
                // OJS (Open Journal Systems) uchun umumiy selectorlar
                '.obj_article_summary',
                '.article-summary',
                '.article_summary',
                '.cmp_article_list .obj_article_summary',
                '.issue-toc .obj_article_summary',
                
                // Boshqa mumkin bo'lgan strukturalar
                '.article-item',
                '.publication-item',
                '.journal-article',
                '.article-entry',
                '.content-item',
                
                // Umumiy HTML elementlar
                'article',
                '.article',
                '.entry',
                '.post'
            ];
            
            let foundElements = [];
            
            // Har bir selectorni sinab ko'rish
            for (const selector of possibleSelectors) {
                const elements = doc.querySelectorAll(selector);
                if (elements.length > 0) {
                    console.log(`${selector} bilan ${elements.length} ta element topildi`);
                    foundElements = Array.from(elements);
                    break;
                }
            }
            
            // Agar maxsus selectorlar ishlamasa, barcha havolalarni qidirish
            if (foundElements.length === 0) {
                console.log('Maxsus selectorlar ishlamadi, barcha havolalarni qidiryapman...');
                const allLinks = doc.querySelectorAll('a[href*="article"], a[href*="view"], a[href*="publication"]');
                foundElements = Array.from(allLinks).slice(0, 15);
            }
            
            console.log(`Jami ${foundElements.length} ta element topildi`);
            
            foundElements.forEach((element, index) => {
                if (index < 10) { // Faqat 10 ta maqola
                    try {
                        // Sarlavhani topish
                        let title = '';
                        const titleSelectors = [
                            '.obj_article_summary h3 a',
                            '.title a',
                            'h3 a',
                            'h2 a', 
                            'h4 a',
                            '.article-title',
                            '.headline',
                            'a'
                        ];
                        
                        for (const titleSelector of titleSelectors) {
                            const titleElement = element.querySelector ? element.querySelector(titleSelector) : null;
                            if (titleElement && titleElement.textContent.trim()) {
                                title = titleElement.textContent.trim();
                                break;
                            }
                        }
                        
                        // Agar element o'zi havola bo'lsa
                        if (!title && element.textContent) {
                            title = element.textContent.trim();
                        }
                        
                        // Muallifni topish
                        let author = '';
                        const authorSelectors = [
                            '.authors',
                            '.author',
                            '.by-author',
                            '.writer',
                            '.obj_article_summary .authors'
                        ];
                        
                        for (const authorSelector of authorSelectors) {
                            const authorElement = element.querySelector ? element.querySelector(authorSelector) : null;
                            if (authorElement && authorElement.textContent.trim()) {
                                author = authorElement.textContent.trim();
                                break;
                            }
                        }
                        
                        // Sanani topish
                        let date = '';
                        const dateSelectors = [
                            '.published',
                            '.date',
                            '.pub-date',
                            '.time',
                            '.obj_article_summary .published'
                        ];
                        
                        for (const dateSelector of dateSelectors) {
                            const dateElement = element.querySelector ? element.querySelector(dateSelector) : null;
                            if (dateElement && dateElement.textContent.trim()) {
                                date = dateElement.textContent.trim();
                                break;
                            }
                        }
                        
                        // Havolani topish
                        let link = '';
                        if (element.href) {
                            link = element.href;
                        } else {
                            const linkElement = element.querySelector('a');
                            if (linkElement && linkElement.href) {
                                link = linkElement.href;
                            }
                        }
                        
                        // Agar sarlavha topilsa, maqolani qo'shish
                        if (title && title.length > 10) {
                            // Sarlavhani tozalash
                            title = title.replace(/\s+/g, ' ').trim();
                            
                            // Nisbiy havolani to'liq havolaga aylantirish
                            if (link && !link.startsWith('http')) {
                                link = 'https://rai-journal.uz' + (link.startsWith('/') ? link : '/' + link);
                            }
                            
                            articles.push({
                                title: title,
                                author: author || 'RAI Journal',
                                date: date || '2024',
                                excerpt: title.length > 150 ? title.substring(0, 150) + '...' : title,
                                link: link || 'https://rai-journal.uz',
                                views: Math.floor(Math.random() * 500) + 100
                            });
                            
                            console.log(`Maqola ${index + 1}: ${title.substring(0, 50)}...`);
                        }
                    } catch (parseError) {
                        console.log(`Element ${index} ni parse qilishda xatolik:`, parseError);
                    }
                }
            });
            
            console.log(`Jami ${articles.length} ta maqola ajratib olindi`);
            return articles;
        }

        // Xatolik xabarini ko'rsatish funksiyasi
        function showErrorMessage() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            const articlesSection = document.getElementById('articlesSection');
            const errorMessage = document.getElementById('errorMessage');
            
            loadingIndicator.style.display = 'none';
            articlesSection.style.display = 'none';
            errorMessage.style.display = 'block';
        }

        // Maqolalarni sahifada ko'rsatish
        function displayArticles(articles) {
            const articlesGrid = document.getElementById('articlesGrid');
            articlesGrid.innerHTML = '';

            articles.forEach(article => {
                const articleCard = document.createElement('div');
                articleCard.className = 'article-card';
                articleCard.innerHTML = `
                    <h3 class="article-title">${article.title}</h3>
                    <div class="article-author">üë§ ${article.author}</div>
                    <p class="article-excerpt">${article.excerpt}</p>
                    <div class="article-meta">
                        <div class="article-date">
                            <i class="fas fa-calendar"></i>
                            <span>${article.date}</span>
                        </div>
                        <div class="article-views">
                            <i class="fas fa-eye"></i>
                            <span>${article.views} ko'rilgan</span>
                        </div>
                    </div>
                    <div class="article-buttons">
                        <a href="${article.link}" target="_blank" class="btn btn-primary">
                            <i class="fas fa-external-link-alt"></i> Maqolani o'qish
                        </a>
                        <a href="https://t.me/ferteach_uz" target="_blank" class="btn btn-success">
                            <i class="fab fa-telegram"></i>
                        </a>
                    </div>
                `;
                articlesGrid.appendChild(articleCard);
            });
        }

        // Sahifa yuklanganda maqolalarni yuklash
        document.addEventListener('DOMContentLoaded', function() {
            loadArticles();
        });
    </script>
</body>
</html>